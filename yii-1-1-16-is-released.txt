
Yii 1.1.6 发布了


我们非常高兴的宣布Yii 框架 1.1.6 已经发布了。你可以在http://yiiframework.com/download/ 下载它。

在这个版本中，我们已经包含了超过120个改进和bug修复。在这个版本中完整的修改，请看修改日志。注意这个版本包含的变化是不向后兼容。请阅读更新介绍来学习如何升级。

我们想要对所有投稿者和使用他们宝贵的时间来帮助提高Yii 和保证这个版本合理发布的人表达我们的感谢。

请注意Yii 1.1 目前是维护模式，也就意味着以后它不会引进主要的新功能。我们目前正在积极的开发和维护Yii 2.0体现出一个新的PHP框架使用了最新的技术。你可以通过Star或者watch Yii 2.0 GitHub的项目来跟随Yii 2.0的开发进度。你也可以跟随Yii推特订阅或者加入Yii Facebook组来联系其它Yii 开发者。

下面我们将概述这个发行版的一些主要改进介绍。
数据库和ActiveRecord

数据库支持在Yii中不断演化。此时我们添加了MariaDb和CUBRID数据库的官方支持。

ODBC 现在可以使用connections通过pdo_odbc，就像下面这样 :

'components'=>array(
    ......
    'db'=>array(
        'class'=>'CDbConnection'
        'driverName'=>'mysql',
        'connectionString'=>'odbc:Driver={MySQL};Server=127.0.0.1;Database=test',
        'username'=>'',
        'password'=>'',
    ),
),

当定义STAT关系和 一个可以使用范围:

public function relations()
{
    return array(
        'recentPostCount'=>array(self::STAT,'Post','author_id','scopes'=>'recentScope'),
    );
}

一个可以在关系查询中指定 post-JOIN 操作(比如. use|force|ignore index())，就下面这样： 

$users=User::model()->findAll(array(
    'select'=>'t.id,t.name',
    'with'=>array(
        'posts'=>array(
            'alias'=>'p',
            'select'=>'p.id,p.title',
            'joinOptions'=>'USE INDEX(post__user)',
        ),
    ),
));

在指南的"Post-JOIN 操作"文章的"Relational Active Record"章节中有详细描述。

CDbCommand::naturalLeftJoin() and CDbCommand::naturalRightJoin() were added to allow adding corresponding join statements to the command.

CDbCommand::naturalLeftJoin() 和 CDbCommand::naturalRightJoin() 


It is now possible to override the models PK using primaryKey() method, even if the table defines one.
Files

CFileHelper got new methods:

    createDirectory() - creates directory recursively setting permissions.
    getExtensionByMimeType() - determines the file extension name based on its MIME type.

Mime-Type detection itself was improved by using the mime.types file from Apache HTTP project.

CFileHelper::removeDirectory() now properly works with symlinked directories. It could be turned off by specifying traverseSymlinks as false in options array.

CFileHelper::findFiles() got new option named absolutePaths. Method returns absolute paths if the option is set to true or relative ones otherwise. Default value is true.

CFileCache got cachePathMode and cacheFileMode properties that could be used to chmod() these.
Upgrades

Multiple libraries we're using in the framework were updated:

    jQuery to 1.11.1.
    jQuery UI to 1.11.2.
    Multifile plugin used by CMultiFileUpload to 1.48.
    HTMLPurifier to 4.6.0.
    i18n data bundled with the framework to CLDR23.1. This adds new locales and has many fixes and additional data for existing ones.

HTML5

When we've first released Yii 1.1 XHTML was the thing. Now it's HTML5 so we've decided to update default application template generated by yiic webapp to use HTML5.

CHtml and CActiveForm got support for HTML5 inputs such as color, datetime, datetime-local, week and search.
Compatibility

Various third party tools and libraries often used with Yii were updated so framework got updates to support these.

    CApcCache is now compatible with APCu.
    Yii::import() and Yii::createComponent() are now able to use third party autoloader such as Composer.
    Yii and YiiBase were added to composer.json autoloading.
    PHPUnit 3.8+ now could be used.

Request

Request now properly reacts when there's X-HTTP-Method-Override header used to emulate various request types via POST.

There are getIsPatchRequest(), getIsPatchViaPostRequest() and getPatch() methods allowing you to work with HTTP PATCH requests.

Framework now responds with HTTP protocol version passed in request.

Request::getPreferredLanguage() is now able to select a best matching between supported and requested languages.
Error handling

Error handling got several improvements.

    You can now access exception object via ErrorHandler::getException(). It allows passing to various third party APIs efficiently.
    Syslog log route is now available out of the box.
    CClientScript now throws exception in case you're trying to register package that doesn't exist.
    CActiveForm::$clientOptions got errorCallback so you can hook to clientside validation process using it.

Others

    Web services got support for SOAP headers and document/literal encoding.
    CJSON can now use JsonSerializable interface when serializing objects.
    CHtml::beginForm() now supports additional HTTP methods, via a hidden _method field.
    CPasswordHelper::generateSalt() now returns salt with $2y$ cost.
    CFormatter is now able to format DateTime instances.
